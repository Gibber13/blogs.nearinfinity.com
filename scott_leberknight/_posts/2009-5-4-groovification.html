--- 
permalink: /blogs/scott_leberknight/groovification.html
layout: blogs
title: Groovification
date: 2009-05-04 17:22:38 -04:00
tags: Groovy Java
---
 <p>Last week I tweeted about groovification, which is defined thusly:</p>

<p><i>groovification.</i> noun. the process of converting java source code into groovy source code (usually done to make development more fun)</p>

<p>On my main day-to-day project, we've been writing unit tests in Groovy for quite a while now, and recently we decided to start implementing new code in Groovy rather than Java. The reason for doing this is to gain more flexibility in development, to make testing easier (i.e. in terms of the ability to mock dependencies in a trivial fashion), to eliminate a lot of Java boilerplate code and thus write less code, and of course to make developing more fun. It's not that I hate Java so much as I feel Java simply isn't innovating anymore and hasn't for a while, and isn't adding features that I simply don't want to live without anymore such as closures and the ability to do metaprogramming when I need to. In addition, it isn't removing features that I don't want, such as checked exceptions. If I know, for a fact, that I can handle an exception, I'll handle it appropriately. Otherwise, when there's nothing I can do anyway, I want to let the damn thing propagate up and just show a generic error message to the user, log the error, and send the admin team an email with the problem details.</p>

<p>This being, for better or worse, a Maven project, we've had some interesting issues with mixed compilation of Java and Groovy code. The <a href="http://groovy.codehaus.org/">GMaven plugin</a> is easy to install and works well but currently has some outstanding issues related to Groovy stub generation, specifically it cannot handle <a href="http://jira.codehaus.org/browse/MGROOVY-108">generics</a> or <a href="http://jira.codehaus.org/browse/MGROOVY-109">enums</a> properly right now. (Maybe someone will be less lazy than me and help them fix it instead of complaining about it.) Since many of our classes use generics, e.g. in service classes that return domain objects, we currently are not generating stubs. We'll convert existing classes and any other necessary dependencies to Groovy as we make updates to Java classes, and we are implementing new code in Groovy. Especially in the web controller code, this becomes trivial since the controllers generally depend on other Java and/or Groovy code, but no other classes depend on the controllers. So starting in the web tier seems to be a good choice. Groovy combined with implementing controllers using the Spring @MVC annotation-based controller configuration style (i.e. no XML configuration), is making the controllers <i>really</i> thin, lightweight, and easy to read, implement, and test.</p>

<p>I estimate it will take a while to fully convert all the existing Java code to Groovy code. The point here is that we are doing it piecemeal rather than trying to do it all at once. Also, whenever we convert a Java file to a Groovy one, there are a few basics to make the classes Groovier without going totally overboard and spending loads of time. First, once you've used <a href="http://www.jetbrains.com/idea/">IntelliJ's</a> move refactoring to move the .java file to the Groovy source tree (since we have src/main/java and src/main/groovy) you can then use IntelliJ's handy-dandy "Rename to Groovy" refactoring. In IntelliJ 8.1 you need to use the "Search - Find Action" menu option or keystroke and type "Rename to..." and select "Rename to Groovy" since they goofed in version 8 and that option was left off a menu somehow. Once that's done you can do a few simple things to make the class a bit more groovy. First, get rid of all the semi-colons. Next, replace getter/setter code with direct property access. Third, replace for loops with "each"-style internal iterators when you don't need the loop index and "eachWithIndex" where you do. You can also get rid of some of the redundant modifiers like "public class" since that is the Groovy default. That's not too much at once, doesn't take long, and makes your code Groovier. Over time you can do more groovification if you like.</p>

<p>The most common gotchas I've found have to do with code that uses anonymous or inner classes since Groovy doesn't support those Java language features. In that case you can either make a non-public named class (and it's OK to put it in the same Groovy file unlike Java as long as it's not public) or you can refactor the code some other way (using your creativity and expertise since we are not <a href="http://www.nearinfinity.com/blogs/scott_leberknight/thinking_matters.html">monkeys</a>, right?). This can sometimes be a pain, especially if you are using a lot of them. So it goes. (And yes, that is a <a href="http://en.wikipedia.org/wiki/Slaughterhouse-Five">Slaughterhouse Five</a> reference.)</p>

<p>Happy groovification!</p> 
